<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evidence přání videií v3.2.0</title>
    <link rel="stylesheet" href="styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
</head>
<body>
    <!-- Loading overlay -->
    <div id="loading-overlay" class="loading-overlay">
        <div class="loading-spinner">
            <i class="fas fa-circle-notch fa-spin"></i>
            <span>Načítání...</span>
        </div>
    </div>

    <!-- Login form -->
    <div id="login-container" class="login-container">
        <div class="login-form">
            <div class="login-header">
                <i class="fas fa-video"></i>
                <h1>Evidence přání videií</h1>
                <p>Verze 3.2.0</p>
            </div>
            <form id="login-form">
                <div class="form-group">
                    <label for="username">Uživatelské jméno</label>
                    <input type="text" id="username" name="username" required>
                </div>
                <div class="form-group">
                    <label for="password">Heslo</label>
                    <input type="password" id="password" name="password" required>
                </div>
                <button type="submit" class="btn btn-primary">
                    <i class="fas fa-sign-in-alt"></i>
                    Přihlásit se
                </button>
            </form>
        </div>
    </div>

    <!-- Main application -->
    <div id="main-app" class="main-app" style="display: none;">
        <!-- Header -->
        <header class="header">
            <div class="header-content">
                <div class="logo">
                    <i class="fas fa-video"></i>
                    <span>Evidence přání videií v3.2.0</span>
                </div>
                <div class="user-info">
                    <span id="current-user"></span>
                    <button id="logout-btn" class="btn btn-secondary">
                        <i class="fas fa-sign-out-alt"></i>
                        Odhlásit
                    </button>
                </div>
            </div>
        </header>

        <!-- Navigation -->
        <nav class="navigation">
            <button class="nav-btn active" data-section="dashboard">
                <i class="fas fa-chart-bar"></i>
                <span>Dashboard</span>
            </button>
            <button class="nav-btn" data-section="records">
                <i class="fas fa-list"></i>
                <span>Denní přehled</span>
            </button>
            <button class="nav-btn" data-section="new-record">
                <i class="fas fa-plus"></i>
                <span>Nový zápis</span>
            </button>
            <button class="nav-btn" data-section="monthly">
                <i class="fas fa-calendar-alt"></i>
                <span>Měsíční přehled</span>
            </button>
            <button class="nav-btn" data-section="yearly">
                <i class="fas fa-chart-line"></i>
                <span>Roční přehled</span>
            </button>
            <button class="nav-btn" data-section="import-export">
                <i class="fas fa-exchange-alt"></i>
                <span>Import/Export</span>
            </button>
            <button class="nav-btn" data-section="users" id="users-nav" style="display: none;">
                <i class="fas fa-users"></i>
                <span>Uživatelé</span>
            </button>
            <button class="nav-btn" id="audit-nav" style="display: none;" onclick="openAuditLogs()">
                <i class="fas fa-shield-alt"></i>
                <span>Audit Log</span>
            </button>
        </nav>

        <!-- Content sections -->
        <main class="content">
            <!-- Dashboard -->
            <section id="dashboard-section" class="section active">
                <div id="dashboard-iframe-container" style="width: 100%; height: calc(100vh - 160px); border: none; overflow: hidden;">
                    <iframe id="dashboard-iframe" src="dashboard.html" style="width: 100%; height: 100%; border: none; display: block;"></iframe>
                </div>
            </section>

            <!-- Denní přehled -->
            <section id="records-section" class="section">
                <div class="section-header">
                    <h2><i class="fas fa-list"></i> Denní přehled</h2>
                    <div class="filters">
                        <select id="stav-filter">
                            <option value="">Všechny stavy</option>
                            <option value="zaplaceno">Zaplaceno</option>
                            <option value="zaslano">Zasláno</option>
                            <option value="odmitnuto">Odmítnuto</option>
                            <option value="rozpracovane">Rozpracované</option>
                        </select>
                        <input type="text" id="prani-filter" placeholder="Filtr přání">
                        <input type="text" id="nick-filter" placeholder="Filtr nick">
                        <input type="date" id="datum-od-filter">
                        <input type="date" id="datum-do-filter">
                        <button id="apply-filters" class="btn btn-primary">
                            <i class="fas fa-filter"></i>
                            Filtrovat
                        </button>
                        <button id="clear-filters" class="btn btn-secondary">
                            <i class="fas fa-times"></i>
                            Vyčistit
                        </button>
                    </div>
                </div>

                <div class="table-container">
                    <table id="records-table" class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Datum</th>
                                <th>Jméno</th>
                                <th>Účet</th>
                                <th>Částka</th>
                                <th>Stav</th>
                                <th>Přání</th>
                                <th>Nick</th>
                                <th>Link</th>
                                <th>Faktura</th>
                                <th>Akce</th>
                            </tr>
                        </thead>
                        <tbody id="records-tbody">
                        </tbody>
                    </table>
                </div>

                <div class="pagination" id="pagination">
                </div>

                <div class="table-actions">
                    <button id="print-table" class="btn btn-secondary">
                        <i class="fas fa-print"></i>
                        Tisknout
                    </button>
                </div>
            </section>

            <!-- Nový zápis -->
            <section id="new-record-section" class="section">
                <div class="section-header">
                    <h2><i class="fas fa-plus"></i> Nový zápis</h2>
                </div>

                <form id="new-record-form" class="form-grid">
                    <div class="form-group">
                        <label for="new-datum">Datum *</label>
                        <input type="date" id="new-datum" name="datum" required>
                    </div>
                    <div class="form-group">
                        <label for="new-jmeno">Jméno *</label>
                        <input type="text" id="new-jmeno" name="jmeno" required>
                    </div>
                    <div class="form-group">
                        <label for="new-ucet">Účet</label>
                        <input type="text" id="new-ucet" name="ucet">
                    </div>
                    <div class="form-group">
                        <label for="new-castka">Částka</label>
                        <input type="number" id="new-castka" name="castka" step="0.01">
                    </div>
                    <div class="form-group">
                        <label for="new-stav">Stav</label>
                        <select id="new-stav" name="stav">
                            <option value="rozpracovane">Rozpracované</option>
                            <option value="zaslano">Zasláno</option>
                            <option value="zaplaceno">Zaplaceno</option>
                            <option value="odmitnuto">Odmítnuto</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="new-nick">Nick</label>
                        <input type="text" id="new-nick" name="nick">
                    </div>
                    <div class="form-group full-width">
                        <label for="new-prani">Přání</label>
                        <textarea id="new-prani" name="prani" rows="3"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="new-link">Link</label>
                        <input type="url" id="new-link" name="link">
                    </div>
                    <div class="form-group">
                        <label for="new-faktura">Faktura</label>
                        <input type="text" id="new-faktura" name="faktura">
                    </div>
                    <div class="form-actions full-width">
                        <button type="submit" class="btn btn-primary">
                            <i class="fas fa-save"></i>
                            Uložit záznam
                        </button>
                        <button type="reset" class="btn btn-secondary">
                            <i class="fas fa-undo"></i>
                            Vyčistit formulář
                        </button>
                    </div>
                </form>
            </section>

            <!-- Měsíční přehled -->
            <section id="monthly-section" class="section">
                <div class="section-header">
                    <h2><i class="fas fa-calendar-alt"></i> Měsíční přehled</h2>
                    <div class="date-selectors">
                        <select id="monthly-year">
                            <!-- Years will be populated by JS -->
                        </select>
                        <select id="monthly-month">
                            <option value="1">Leden</option>
                            <option value="2">Únor</option>
                            <option value="3">Březen</option>
                            <option value="4">Duben</option>
                            <option value="5">Květen</option>
                            <option value="6">Červen</option>
                            <option value="7">Červenec</option>
                            <option value="8">Srpen</option>
                            <option value="9">Září</option>
                            <option value="10">Říjen</option>
                            <option value="11">Listopad</option>
                            <option value="12">Prosinec</option>
                        </select>
                        <button id="load-monthly" class="btn btn-primary">
                            <i class="fas fa-search"></i>
                            Načíst přehled
                        </button>
                    </div>
                </div>

                <div id="monthly-overview" class="overview-container">
                    <div class="overview-cards">
                        <!-- Cards will be populated by JS -->
                    </div>
                </div>
            </section>

            <!-- Roční přehled -->
            <section id="yearly-section" class="section">
                <div class="section-header">
                    <h2><i class="fas fa-chart-line"></i> Roční přehled</h2>
                    <div class="date-selectors">
                        <select id="yearly-year">
                            <!-- Years will be populated by JS -->
                        </select>
                        <button id="load-yearly" class="btn btn-primary">
                            <i class="fas fa-search"></i>
                            Načíst přehled
                        </button>
                    </div>
                </div>

                <div id="yearly-overview" class="overview-container">
                    <div class="yearly-table-container">
                        <!-- Table will be populated by JS -->
                    </div>
                </div>
            </section>

            <!-- Import/Export -->
            <section id="import-export-section" class="section">
                <div class="section-header">
                    <h2><i class="fas fa-exchange-alt"></i> Import/Export</h2>
                </div>

                <div class="import-export-grid">
                    <div class="card">
                        <h3><i class="fas fa-download"></i> Export do CSV</h3>
                        <div class="form-group">
                            <label for="export-datum-od">Datum od</label>
                            <input type="date" id="export-datum-od">
                        </div>
                        <div class="form-group">
                            <label for="export-datum-do">Datum do</label>
                            <input type="date" id="export-datum-do">
                        </div>
                        <button id="export-csv" class="btn btn-primary">
                            <i class="fas fa-file-export"></i>
                            Exportovat CSV
                        </button>
                    </div>

                    <div class="card">
                        <h3><i class="fas fa-upload"></i> Import z CSV</h3>
                        <div class="form-group">
                            <label for="import-file">Vyberte CSV soubor</label>
                            <input type="file" id="import-file" accept=".csv">
                        </div>
                        <button id="import-csv" class="btn btn-primary">
                            <i class="fas fa-file-import"></i>
                            Importovat CSV
                        </button>
                        <div class="help-text">
                            <small>Formát CSV: Datum;Jméno;Účet;Částka;Stav;Přání;Nick;Link;Faktura</small>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Správa uživatelů -->
            <section id="users-section" class="section">
                <div class="section-header">
                    <h2><i class="fas fa-users"></i> Správa uživatelů</h2>
                    <button id="add-user-btn" class="btn btn-primary">
                        <i class="fas fa-user-plus"></i>
                        Přidat uživatele
                    </button>
                </div>

                <div class="table-container">
                    <table id="users-table" class="data-table">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Uživatelské jméno</th>
                                <th>Role</th>
                                <th>Vytvořeno</th>
                                <th>Akce</th>
                            </tr>
                        </thead>
                        <tbody id="users-tbody">
                        </tbody>
                    </table>
                </div>
            </section>
        </main>
    </div>

    <!-- Modal pro editaci záznamu -->
    <div id="edit-record-modal" class="modal">
        <div class="modal-content modal-edit">
            <div class="modal-header">
                <h3>Editace záznamu</h3>
                <span class="close">&times;</span>
            </div>
            <form id="edit-record-form" class="form-grid">
                <input type="hidden" id="edit-record-id" name="id">
                <div class="form-group">
                    <label for="edit-datum">Datum *</label>
                    <input type="date" id="edit-datum" name="datum" required>
                </div>
                <div class="form-group">
                    <label for="edit-jmeno">Jméno *</label>
                    <input type="text" id="edit-jmeno" name="jmeno" required>
                </div>
                <div class="form-group">
                    <label for="edit-ucet">Účet</label>
                    <input type="text" id="edit-ucet" name="ucet">
                </div>
                <div class="form-group">
                    <label for="edit-castka">Částka</label>
                    <input type="number" id="edit-castka" name="castka" step="0.01">
                </div>
                <div class="form-group">
                    <label for="edit-stav">Stav</label>
                    <select id="edit-stav" name="stav">
                        <option value="rozpracovane">Rozpracované</option>
                        <option value="zaslano">Zasláno</option>
                        <option value="zaplaceno">Zaplaceno</option>
                        <option value="odmitnuto">Odmítnuto</option>
                    </select>
                </div>
                <div class="form-group">
                    <label for="edit-nick">Nick</label>
                    <input type="text" id="edit-nick" name="nick">
                </div>
                <div class="form-group full-width">
                    <label for="edit-prani">Přání</label>
                    <textarea id="edit-prani" name="prani" rows="3"></textarea>
                </div>
                <div class="form-group">
                    <label for="edit-link">Link</label>
                    <input type="url" id="edit-link" name="link">
                </div>
                <div class="form-group">
                    <label for="edit-faktura">Faktura</label>
                    <input type="text" id="edit-faktura" name="faktura">
                </div>
                <div class="form-actions full-width">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i>
                        Uložit změny
                    </button>
                    <button type="button" class="btn btn-secondary close-modal">
                        <i class="fas fa-times"></i>
                        Zrušit
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal pro přidání/editaci uživatele -->
    <div id="user-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3 id="user-modal-title">Přidat uživatele</h3>
                <span class="close">&times;</span>
            </div>
            <form id="user-form">
                <input type="hidden" id="user-id" name="id">
                <div class="form-group">
                    <label for="user-username">Uživatelské jméno *</label>
                    <input type="text" id="user-username" name="username" required>
                </div>
                <div class="form-group" id="password-group">
                    <label for="user-password">Heslo *</label>
                    <input type="password" id="user-password" name="password" required>
                </div>
                <div class="form-group">
                    <label for="user-role">Role</label>
                    <select id="user-role" name="role">
                        <option value="user">Uživatel</option>
                        <option value="admin">Administrátor</option>
                    </select>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i>
                        Uložit
                    </button>
                    <button type="button" class="btn btn-secondary close-modal">
                        <i class="fas fa-times"></i>
                        Zrušit
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal pro změnu hesla -->
    <div id="password-modal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h3>Změna hesla</h3>
                <span class="close">&times;</span>
            </div>
            <form id="password-form">
                <input type="hidden" id="password-user-id" name="user_id">
                <div class="form-group">
                    <label for="new-password">Nové heslo *</label>
                    <input type="password" id="new-password" name="new_password" required>
                </div>
                <div class="form-group">
                    <label for="confirm-password">Potvrzení hesla *</label>
                    <input type="password" id="confirm-password" name="confirm_password" required>
                </div>
                <div class="form-actions">
                    <button type="submit" class="btn btn-primary">
                        <i class="fas fa-save"></i>
                        Změnit heslo
                    </button>
                    <button type="button" class="btn btn-secondary close-modal">
                        <i class="fas fa-times"></i>
                        Zrušit
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal pro detailní zobrazení záznamu -->
    <div id="record-detail-modal" class="modal">
        <div class="modal-content modal-detail">
            <div class="modal-header">
                <h3>Detailní zobrazení záznamu</h3>
                <span class="close">&times;</span>
            </div>
            <div id="record-detail-content" class="record-detail-content">
                <!-- Content will be populated by JS -->
            </div>
            <div class="modal-actions">
                <button id="print-detail" class="btn btn-primary">
                    <i class="fas fa-print"></i>
                    Tisknout
                </button>
                <button type="button" class="btn btn-secondary close-modal">
                    <i class="fas fa-times"></i>
                    Zavřít
                </button>
            </div>
        </div>
    </div>

    <!-- Notifications -->
    <div id="notifications" class="notifications"></div>

    <script src="app.js"></script>
</body>
</html>